{% extends 'base.html.twig' %}

{% block title %}Bassin
{% endblock %}

{% block body %}

	<style>
		#text{
			display:none!important;
		}
	</style>
    
	<div class="container-fluid">
		<nav aria-label="breadcrumb">
			<ol class="breadcrumb">
				<li class="breadcrumb-item">
					<a href="{{ path('experimentation_index') }}">Experimentations</a>
				</li>
				<li class="breadcrumb-item">
					<a href="{{ path('lot_index', {'idExpe': idExpe}) }}">Lots</a>
				</li>
				<li class="breadcrumb-item active" aria-current="page">Bassins</li>
			</ol>
		</nav>

		<h1>
			Bassin {{ bassins[0].nomBassin }}, 
			Type {{ bassins[0].nomTypeBassin }}, 
			Numéro {{ bassins[0].numeroBassin }}, 
			Rfid {{ bassins[0].tagRfid }}, 
			Zone <a target="_blank" href="{{ path('bassin_zone', {'idLot': idLot, 'idExpe': idExpe, 'idBassin': bassins[0].idBassin}) }}">{{ bassins[0].nomZone }}</a>:
		</h1>

		<table class="table table-bordered table-hover" id="tableLot">
			<thead>
				<tr>
					<th>Volume</th>
					<th>Debut UV</th>
					<th>Fin Uv</th>
					<th>Date Relevé</th>
					<th>Valeur Relevé</th>
					<th>LibTypeRelBassin</th>
					<th>Actions</th>
				</tr>
			</thead>
			<tbody>
				<script>
					const temps = new Array();
					const dates = new Array();
				</script>
				{% for bassin in bassins %}

					<tr>
						<td>{{ bassin.volume }}</td>
						<td>{{ bassin.debutUv ? bassin.debutUv|date('Y-m-d') : '' }}</td>
						<td>{{ bassin.finUv ? bassin.finUv|date('Y-m-d') : '' }}</td>
						<td>{{ bassin.dateRelBassin ? bassin.dateRelBassin|date('Y-m-d') : '' }}</td>
						<td>{{ bassin.valeurRelBassin }}</td>
						<td>{{ bassin.libTypeRelBassin }}</td>
						<td><a href="{{ path('alimentation_eau_index', {'idLot': idLot, 'idExpe': idExpe, 'idBassin': bassin.idBassin}) }}" style="margin:3px;" class="btn btn-primary">Voir la source</a>
						{# <script>
							temps.push({{ bassin.releveTempDefaut }})
							
							var year = ( ({{ bassin.dateRelBassin ? bassin.dateRelBassin|date('Y') : '' }}).toString() )
							var month = ( ({{ bassin.dateRelBassin ? bassin.dateRelBassin|date('m') : '' }}).toString() )
							var day = ( ({{ bassin.dateRelBassin ? bassin.dateRelBassin|date('d') : '' }}).toString() )
							dates.push(day.concat('/',month,'/',year))
						</script> #}
					</tr>

				{% else %}
					<tr>
						<td colspan="25">Aucun résultat</td>
					</tr>
				{% endfor %}
			</tbody>
		</table>
		{#
		<div><canvas id="chartBassin" style="max-width:100%; max-height:500px;"></canvas></div>
		<script>
			const ctx = document.getElementById('chartBassin').getContext('2d');
			const myChart = new Chart(ctx, {
				type: 'line',
				data: {
					labels: dates,
					datasets: [{
						label: 'Température',
						data: temps,
						backgroundColor: [
							'rgba(255, 0, 0, 0.2)'
						],
						borderColor: [
							'rgba(255, 0, 0, 1)',
						],
						borderWidth: 1
					}]
				},
				options: {
					scales: {
						y: {
							beginAtZero: true
						}
					}
				}
			});
		</script>
		#}
		<br><br>
		<a href="{{ path('lot_index', {'idExpe': idExpe}) }}" class="btn btn-danger">Retour</a>
	</div>
{% endblock %}
